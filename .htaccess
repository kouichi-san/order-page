# index.html を既定に
DirectoryIndex index.html

RewriteEngine On

# すでに /index.html なら何もしない（ループ止め）
RewriteRule ^index\.html$ - [L]

# ルートに来たら内部的に index.html を配信（リダイレクトしない）
RewriteRule ^$ index.html [L]

# 常時HTTPS（HTTPS時は再発火させない）
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# （必要なら）www 非www を片方に統一 ※どちらか片方のみ
# RewriteCond %{HTTP_HOST} !^www\.example\.jp$ [NC]
# RewriteRule ^ https://www.example.jp%{REQUEST_URI} [R=301,L]

# GASへのfetch許可（CSP）
<IfModule mod_headers.c>
  Header always set Content-Security-Policy "default-src 'self'; connect-src 'self' https://script.google.com https://script.googleusercontent.com https://ssl.gstatic.com; img-src * data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'"
</IfModule>
