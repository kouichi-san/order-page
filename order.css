/* =====================================================================
   order.css  (2025-10-16 完全版)
   - PC/SP共通：フッターの「戻る／注文へ進む」右寄せ fix
   - SPカート行：商品名は上段、画像は行2〜4ぶち抜き
                  右列は [単価 → 数量 → 削除] の3行、行5（合計）は表示しない
   - 文面変更はHTML側（「連絡欄」など）で対応済み／本CSSは見た目のみ
   ===================================================================== */

/* === CSS Layers (固定) === */
@layer reset, base, components, utilities, overrides;

/* 例：ブラウザ初期化 */
@layer reset {
  /* normalize等があればここ */
}

/* 例：共通トークン/タイポ/色 */
@layer base {
  :root{
    --col-gap: 16px;
    --sp-cart-left-col: 25%; /* SPドロワ左列の幅：調整はここだけ */
  }
}

/* 例：コンポーネント本体（触るな危険ゾーン） */
@layer components {
  .cart .lbl-min { display:block; }
  /* SPカートドロワのレイアウト（確定仕様） */
  .ppp-cartdrawer{ display:grid; /* 既存に合わせる */ }
  .cart-footer{
    display:grid;
    grid-template-columns:auto auto 1fr auto;
    align-items:center;
    gap:6px;
    padding:8px 10px;
    width:100%;
    background:#f8fafc; /* 既存のドロワフッター色に合わせるなら削除可 */
    border-top:1px solid var(--border);
  }
  .cart-footer .sumcount,
  .cart-footer .sumtotal{
    line-height:1.1;
  }
  .cart-footer .actions-back .ppp-btn,
  .cart-footer .actions-next .ppp-btn{
    height:var(--btn-h,44px);
    white-space:nowrap;
  }
    .cart-footer{
    display: grid;
    grid-template-columns: auto auto 1fr auto;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    width: 100%;
    background: var(--drawer-bg, #f8fafc);
    /* 水平線は親で消すのでここでは付けない */
  }
  .cart-footer .sumcount,
  .cart-footer .sumtotal { line-height: 1.1; }

  /* 合計点数ブロックのセンタリングを崩さない（フォント差が出ても中央） */
  .cart-footer .sumcount { text-align: center; }

  /* 値のタイポを統一（PC/SP共通）。clampで端末差を吸収 */
  .cart-footer .sumcount .val,
  .cart-footer .sumtotal .val {
    font-weight: 800;
    font-size: clamp(14px, 2.3vw, 18px);
  }

  /* 右2カラムは右寄せ固定 */
  .cart-footer .actions-back { justify-self: end; }
  .cart-footer .actions-next { justify-self: end; }
}

/* 例：ユーティリティ（小さな補助、safe） */
@layer utilities {
  .u-right { text-align: right; }
  .u-hide  { display: none !important; }
  .muted{ font-size:13px; color:#6b7280; padding:8px 4px }
  .ppp-fav.active{ background:#fef2f2; border-color:#fecaca; color:#ef4444 }

}

/* 例：最終上書き（緊急パッチ枠のみ） */
@layer overrides {
  /* PCではSP用の2行表示を隠し、ピルだけにする */
  @media (min-width:421px){
    .cart .lbl-min,
    .cart .val-date { display:none !important; }
    .cart .inline-pill { display:inline-flex !important; }
  } 
  .cart-footer .sumcount .lbl,
  .cart-footer .sumtotal .lbl{
    font-size:11px;
    color:var(--muted,#64748b);
  }
  .cart-footer .sumcount .val{
    font-weight:800;
    text-align:center; /* 合計点数ラベルと値を中央寄せ */
  }
  .cart-footer .sumtotal .val{
    font-weight:800;
  }
  .cart-footer .actions-back{ justify-self: end; }
  .cart-footer .actions-next{ justify-self: end; }
  @media (min-width:768px){
    .cart-footer{ gap:12px; padding:10px 16px; }
    /* .cart .inline-pill { display:none; } */
  }
    /* SP：あとで/お気に入り の「解除」ボタンを行4右寄せ＆二行対応で統一 */
  @media (max-width:420px){
    #laterList .qtybar .btn[data-later-del],
    #favList   .qtybar .btn[data-fav-del]{
      /* 位置を明示して自動回りのブレを消す */
      grid-column: 2;
      grid-row: 4;
      justify-self: end;

      /* 見た目（2行許容） */
      height: auto;          /* 固定40pxを解除 */
      min-height: 40px;      /* 1行時は40pxを維持 */
      max-width: 10em;       /* 幅を統一（調整可） */
      padding: 6px 10px;
      line-height: 1.15;
      white-space: normal;   /* 折返し可 */
      text-align: center;
      font-weight: 800;      /* 既存のトーンに合わせる */
      /* 必要なら font-size:13px; も可 */
    }

    /* 「解除」（短文）も幅を合わせて見た目を揃える */
    #laterList .qtybar .btn[data-later-del]{ width: 10em; }
  }
    /* 見出しに区切り線と余白（全セクション共通） */
  .cartlbl{
    display:flex; align-items:center; gap:8px;
    font-weight:800; font-size:13px; color:#334155;
    border-top:1px dashed #eef2f7; padding-top:12px; margin-top:16px;
  }

  /* 各セクションのカード色味・左帯・バッジ（HTML変更なし） */
  /* カート */
  #cartList .cartrow{ background:#ffffff; }
  /* あとで */
  #laterList .cartrow{
    background:#fffbeb; border-color:#fde68a; border-left:6px solid #facc15;
  }
  /* お気に入り */
  #favList .cartrow{
    background:#fef2f2; border-color:#fecaca; border-left:6px solid #f87171;
  }
  /* 折りたたみ（details/summary） */
  .collapsible{ margin-top:12px; }
  .collapsible > summary.cartlbl{
    border-top: 2px solid #cbd5e1; /* 濃い実線 */
    padding-top: 12px;
    cursor: pointer;
    display: flex; align-items: center; gap: 8px;
    list-style: none;
  }
  /* 既定の三角は非表示にして自前のシェブロン */
  .collapsible > summary::-webkit-details-marker{ display:none }
  .collapsible > summary::after{
    content: '›';
    margin-left: auto;
    transform: rotate(0deg);       /* デフォルト閉＝右向き */
    transition: transform .15s ease;
    font-size: 16px; opacity: .6;
  }
  .collapsible[open] > summary::after{ transform: rotate(90deg); } /* 開くと下向き */

  /* 件数を強調（太字・わずかに大きく） */
  .cartnum{
    font-weight: 900;  /* ← 太字で強調 */
    font-size: 13px;
    color:#1f2937;
  }
  .collapsible:not([open]) > summary::after{ transform: rotate(0deg); }

  /* 件数表示の体裁 */
  .cartnum{ font-weight:700; font-size:12px; color:#64748b; }

  /* ① メニューボタン（「すべて/カテゴリ/並べ替え/お気に入り」）をタイト化 */
  .menubar-in .ppp-btn,
  .menubar-in .menu-iconbtn{
    height: 28px;              /* 34px → 28px */
    padding: 0 10px;           /* 横の余白少し詰める */
    border-radius: 10px;
  }

  /* スマホでボタンが折り返す時の余白を小さめに */
  .menubar-in .ppp-btn{ margin-right: 8px; margin-bottom: 6px; }

  /* ② 折りたたみ検索バー：上の余白をさらに詰める */
  .searchbar{ padding: 6px 0 0; }
  .searchbar.is-open{ max-height: 56px; }   /* 64px → 56px でキーボード表示時の圧迫感を軽減 */

  /* ③ 入力フィールドをタイト化（iOSズーム防止の16pxは維持） */
  .menu-search{
    width: 100%;
    height: 36px;              /* 40px → 36px（行間は16pxフォントでOK） */
    padding: 6px 12px;         /* 8px → 6px（左右は12pxで“ぼんやり”感を抑制）*/
    font-size: 16px;           /* ★ズーム防止のため据え置き */
    line-height: 1.2;
    border-radius: 8px;        /* 10px → 8px で見た目を締める */
  }

  /* ④ クリアボタン（×）の当たり判定は確保しつつ控えめに */
  .searchbox{ position: relative; }
  .search-clear{
    position: absolute; right: 6px; top: 50%; transform: translateY(-50%);
    width: 28px; height: 28px; font-size: 18px;
    color: #666; background: transparent; border: 0; border-radius: 14px;
  }
  .menu-search{ padding-right: 38px; } /* 右側の×と被らないように少しだけ余白 */

}


@layer components {
/* ===== CSS変数・ベース ===== */
:root{
  --bg:#fafafa;
  --ink:#1f2937;
  --muted:#6b7280;
  --brand:#10b981;
  --brand-ink:#064e3b;
  --border:#e5e7eb;
  --wrap:1080px;
  --btn-h:44px;
  --btn-radius:10px;
  --z-sticky:50;
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0;
  font-family:system-ui,-apple-system,"Segoe UI","Helvetica Neue",Arial,"Hiragino Sans","Noto Sans JP","Yu Gothic","Meiryo",sans-serif;
  color:var(--ink);
  background:#fff;
}
.wrap{ max-width:var(--wrap); width:100%; margin:0 auto; padding:0 16px }

/* ===== ヘッダー ===== */
header{ background:#fff; border-bottom:1px solid var(--border) }
.header-in{ display:flex; align-items:center; padding:12px 0 }
.brand{
  font-size:20px; font-weight:800; text-indent:.4em; position:relative;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.brand::before{
  content:""; position:absolute; left:0; top:50%; transform:translateY(-50%);
  width:4px; height:1.2em; border-radius:2px; background:var(--brand);
}

/* ===== メニューバー ===== */
.menubar{ position:sticky; top:0; z-index:var(--z-sticky); background:#fff; border-bottom:1px solid var(--border) }
.menubar-in{ display:flex; gap:8px; align-items:center; padding:10px 0 }
.menu-pill{
  font-size:13px; font-weight:700; color:#0f172a; background:#f1f5f9;
  border:1px solid #e2e8f0; border-radius:var(--btn-radius);
  padding:8px 12px; white-space:nowrap; cursor:pointer;
}
.menu-pill[aria-pressed="true"]{
  background:#e6f7f1; border-color:#bbf7d0; color:#065f46;
}
.menu-right{ margin-left:auto }

/* ▼ カテゴリボタン（選択時のクリア×） */
#btnCategories.has-filter{ padding-right:28px; position:relative }
#btnCategories .tag{ font-weight:800; color:#0f172a }
#btnCategories .sep::before{ content:"›"; margin:0 4px; color:#94a3b8 }
#btnCategories .x{
  position:absolute; right:8px; top:50%; transform:translateY(-50%);
  width:20px; height:20px; border-radius:6px; border:1px solid #e5e7eb;
  display:grid; place-items:center; font-size:12px; cursor:pointer; background:#fff;
}
#btnCategories .x:active{ transform:translateY(-50%) translateY(1px) }
@media (max-width:420px){
  #btnCategories{ padding-right:12px }
}

/* ===== 並べ替えバー ===== */
.sortbar{ display:none; background:#fff; border-bottom:1px solid #eef2f7 }
.sortbar[aria-hidden="false"]{ display:block }
.sortbar-in{
  max-width:var(--wrap); margin:0 auto; padding:8px 16px;
  display:flex; gap:8px; align-items:center; flex-wrap:wrap;
}
.sortbar .lbl{ font-size:12px; color:#64748b; margin-right:4px }
.sortbtn{
  font-size:12px; font-weight:800; color:#0f172a; background:#f8fafc;
  border:1px solid #e5e7eb; border-radius:999px; padding:6px 10px; cursor:pointer;
}
.sortbtn.active{ background:#e6f7f1; border-color:#bbf7d0; color:#065f46 }

/* ===== 商品カード（ノータッチ方針） ===== */
#productGrid.ppp-grid{ display:grid; grid-template-columns:repeat(2,540px); justify-content:space-between; gap:0 }
.ppp-card{ width:540px; background:#fff; border:1px solid var(--border); border-radius:16px; overflow:hidden }
.ppp-crumbrow{ display:block; padding:10px 12px 0 }
.ppp-crumb{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; color:#475569; font-size:12px }
.ppp-crumb a{ color:#0ea5e9; text-decoration:underline; text-underline-offset:2px; cursor:pointer }
.ppp-crumb a:hover{ color:#0284c7 } .ppp-crumb a:active{ opacity:.6 }
.ppp-titlebar{ display:flex; gap:8px; align-items:flex-start; padding:4px 12px 8px }
.ppp-name{ flex:1; font-weight:800; line-height:1.3; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden }
.ppp-fav{ width:32px; height:32px; border-radius:8px; background:#fff; border:1px solid var(--border); display:grid; place-items:center; cursor:pointer }
.ppp-mi{ display:grid; grid-template-columns:minmax(160px,6fr) minmax(140px,4fr); column-gap:12px; align-items:start; padding:0 12px }
.ppp-mi > .ppp-media, .ppp-mi > .ppp-info { min-width:0 }
.ppp-img{ aspect-ratio:4/3; border:1px solid var(--border); border-radius:12px; overflow:hidden; background:#fff }
.ppp-img>img{ width:100%; height:100%; object-fit:contain; display:block }
/* .ppp-prenote{ background:#f8fafc; border:1px solid #e2e8f0; border-radius:8px; padding:6px 8px; font-size:13px; color:#334155; white-space:nowrap; overflow:hidden; text-overflow:ellipsis } */
.ppp-prenote{ font-size:11px; color:#334155; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
.ppp-price{ font-weight:900; font-size:22px }
.ppp-unit{ font-size:12px; color:#6b7280; text-align:right }
.ppp-actions{ display:grid; grid-template-columns:7fr 3fr; gap:8px; margin-bottom:10px }
.ppp-btn{
  appearance:none; border:1px solid var(--border); background:#fff; border-radius:12px;
  cursor:pointer; font-weight:800; display:inline-flex; align-items:center; justify-content:center;
  height:var(--btn-h); white-space:nowrap; min-width:0; padding:0 12px; font-size:clamp(13px,1.6vw,16px)
}
/* NOTE: カード用の .ppp-btn は幅可変にするため flex 指定なし */
.ppp-btn.add{ background:var(--brand); color:#fff; border-color:transparent }
.ppp-btn.add:active{ transform:translateY(1px) }
.ppp-vars{ display:flex; flex-direction:column; gap:4px; margin-top:2px }
.ppp-pill{ width:100%; padding:6px 8px; border:1px solid var(--border); background:#fff; border-radius:10px; cursor:pointer; font-weight:700; font-size:13px }
.ppp-descwrap{ display:grid; grid-template-columns:1fr auto; gap:8px; align-items:end; padding:0 12px 12px }
.ppp-desc{ font-size:13px; color:#6b7280; line-height:1.5; min-height:calc(1.5 * 3 * 1em); display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden }
/* UNUSED: MOREは現仕様で非表示のため残置だけど不使用
.more--chev{ display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; border-radius:8px; border:1px solid #e5e7eb; background:#fff; text-decoration:none; color:#0ea5e9 }
.more--chev::before{ content:"›"; font-size:18px; line-height:1 }
.more--chev:active{ transform: translateY(1px) }
*/
@media(max-width:720px){
  #productGrid.ppp-grid{ grid-template-columns:1fr; gap:12px }
  .ppp-card{ width:auto }
}

/* ===== 固定フッター（ベース） ===== */
.cart{ position:sticky; bottom:0; left:0; right:0; background:#fff; border-top:1px solid var(--border) }
.cart .wrap{ padding:0 16px }
.cart-box{
  display:flex; align-items:center; gap:16px;
  justify-content:flex-end;
  padding:10px 0; padding-bottom:calc(10px + env(safe-area-inset-bottom));
}
.cart-left{ margin-right:auto; display:flex; align-items:center; gap:12px }
.inline-pill{ font-size:14px; background:#f0fdf4; color:var(--brand-ink); border:1px solid #d1fae5; border-radius:999px; padding:6px 14px; white-space:nowrap }
.count{ min-width:60px; text-align:right; font-size:14px }
.total{ min-width:80px; text-align:right; font-weight:900; font-size:18px }
.btn-cart{ background:var(--brand); color:#fff; border:none; border-radius:var(--btn-radius); padding:10px 18px; cursor:pointer; font-weight:800; white-space:nowrap }
.btn-cart:active{ transform:translateY(1px) }

/* --- SPフッター（2行×3列） --- */
@media(max-width:420px){
  .cart-box{
    display:grid; grid-template-columns: 1fr 1fr auto; grid-template-rows: auto auto;
    gap:4px 12px; align-items:center;
    padding:6px 0; padding-bottom:calc(6px + env(safe-area-inset-bottom));
  }
  .inline-pill{ display:none }
  .lbl-min{ grid-column:1; grid-row:1; font-size:12px; color:#065f46; opacity:.95 }
  .count{ grid-column:2; grid-row:1; text-align:right; font-weight:700 }
  .count::before{ content:"商品点数 "; font-size:12px; font-weight:600; opacity:.9; margin-right:4px }
  .val-date{ grid-column:1; grid-row:2; font-weight:700; font-size:14px; white-space:nowrap }
  .total{ grid-column:2; grid-row:2; text-align:right; font-size:17px }
  .total::before{ content:"合計金額 "; font-size:12px; font-weight:600; opacity:.9; margin-right:4px }
  .btn-cart{ grid-column:3; grid-row:1 / 3; align-self:stretch; padding:10px 14px; min-width:72px }
  .cart::after{ content:""; display:block; height:env(safe-area-inset-bottom); background:#fff }
}

/* PCではSP用ラベルを隠す */
@media(min-width:421px){
  .lbl-min{ display:none }
  .val-date{ display:none }
}

/* ===== ドロワー（共通） ===== */
.ppp-drawer{ position:fixed; inset:0; z-index:4000; display:none }
.ppp-drawer[aria-hidden="false"]{ display:block }
.ppp-drawer__scrim{ position:absolute; inset:0; background:rgba(0,0,0,.18); opacity:0; transition:opacity .18s ease; z-index:0 }
.ppp-drawer[aria-hidden="false"] .ppp-drawer__scrim{ opacity:1 }
.ppp-drawer__panel{
  position:absolute; top:0; right:0; height:100%; width:100%;
  max-width:420px; background:#fff; box-shadow:-10px 0 24px rgba(0,0,0,.16);
  transform:translateX(100%); transition:transform .24s ease;
  display:grid; grid-template-rows:auto auto 1fr auto; overflow:hidden;
  padding-bottom:env(safe-area-inset-bottom); z-index:1;
}
@media(min-width:768px){ .ppp-drawer__panel{ max-width:560px } }
@media(min-width:1024px){ .ppp-drawer__panel{ max-width:640px } }
@media(min-width:1280px){ .ppp-drawer__panel{ max-width:720px } }
.ppp-drawer[aria-hidden="false"] .ppp-drawer__panel{ transform:translateX(0) }
.ppp-drawer__bar{ display:flex; align-items:center; gap:8px; padding:12px 14px; border-bottom:1px solid var(--border) }
.ppp-drawer__title{ font-weight:800; font-size:16px; flex:1 }
.ppp-due{ margin-left:6px; font-size:11px; color:#475569; background:#f1f5f9; border:1px solid #e2e8f0; border-radius:999px; padding:2px 6px; white-space:nowrap }
.ppp-iconbtn{ appearance:none; border:1px solid var(--border); background:#fff; border-radius:10px; padding:8px 10px; cursor:pointer }
.ppp-iconbtn:active{ transform:translateY(1px) }
.ppp-chips{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; padding:8px 14px; border-bottom:1px dashed #eef2f7 }
.ppp-chip{ font-size:12px; background:#f8fafc; border:1px solid #e5e7eb; border-radius:999px; padding:4px 8px }
.ppp-listwrap{ overflow:auto; -webkit-overflow-scrolling:touch }
.ppp-listpad{ padding:10px 12px 16px }
.ppp-drawer__footer{ display:flex; gap:10px; padding:10px 14px; background:#fafafa }

/* ドロワーボタン（グローバル） */
.ppp-btn{ flex:1 } /* ← 他所で使う場合があるので残す */
.ppp-btn.primary{ background:var(--brand); color:#fff; border-color:transparent }
.ppp-btn.primary.is-disabled{ opacity:.5; cursor:not-allowed }
.ppp-btn.neutral{ background:#f3f4f6; border:1px solid var(--border); color:#111827 }
.ppp-btn.neutral:hover{ background:#e5e7eb }

/* --- 右寄せFIX：フッター内だけ .ppp-btn の flex:1 を無効化 --- */
.ppp-drawer__footer .ppp-btn{ flex:0 0 auto }  /* ← これが効かないと右寄せできない */
/* .cart-footer{ display:flex; align-items:center; justify-content:flex-end; gap:10px } */
.cart-footer .cart-sum{ margin-right:auto }

/* ===== カート中身・フォーム（PCの基本並び） ===== */
.cartlist{ display:flex; flex-direction:column; gap:10px }
.cartrow{ border:1px solid var(--border); border-radius:8px; padding:10px; background:#fff }
.rowline{ display:grid; grid-template-columns:7fr 3fr; gap:8px; align-items:baseline }
.rowline .ttl{ font-weight:800; min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.rowline .prc{ font-weight:700; text-align:right }
.g2{ display:grid; grid-template-columns:112px 1fr; gap:8px; align-items:center }
.thumb{ width:112px; height:80px; border-radius:8px; border:1px solid var(--border); background:#f3f4f6; overflow:hidden }
.thumb img{ width:100%; height:100%; object-fit:cover }
.qtybar{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:flex-end }
.qtybar .group{ display:inline-flex; gap:8px; align-items:center }
.qtybar .btn{ border:1px solid var(--border); background:#fff; border-radius:8px; height:40px; min-width:40px; font-weight:800; cursor:pointer }
.cartqty{ width:72px; height:40px; border:1px solid var(--border); border-radius:8px; text-align:center; font-weight:700 }
.totalline{ margin-top:6px; text-align:right; font-weight:800 }

/* ===== SP（〜420px）: 指定の新レイアウト =====
   親を 2列(25%｜1fr) × 5行(商品名/単価/数量/削除/合計) に設定。
   ★今回の変更点：
     - 行1のタイトルを「全幅ぶち抜き」（grid-column:1 / span 2）に変更
     - 行4の削除ボタンを右寄せ（justify-self:end）に変更
     - 行5（合計）は非表示（.totalline を display:none）
   =================================================================== */
@media (max-width:420px){
  .cartrow{
    display:grid;
    grid-template-columns:var(--sp-cart-left-col) 1fr; /* ← baseレイヤの変数を実際に使用 */
    grid-template-rows:auto auto auto auto auto;
    column-gap:8px; align-items:start;
  }

  /* 中間の“箱”を溶かして中身を親に直置き */
  .rowline{ display:contents }  /* .ttl, .prc を直配置 */
  .g2{ display:contents }       /* .thumb, .qtybar を直配置 */
  .qtybar{ display:contents }   /* .group(数量), 削除btn を直配置 */

  /* 行1: タイトル（全幅ぶち抜き・左寄せ） */
  .rowline .ttl{
    grid-column:1 / span 2; grid-row:1;  /* ← full width */
    font-weight:800; min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
  }

  /* 行2〜4: 画像（左列 4:3 ぶち抜き） */
  .thumb{
    grid-column:1; grid-row:2 / span 3;
    width:100%; height:auto; aspect-ratio:4/3; align-self:start;
    border-radius:8px; overflow:hidden;
  }

  /* 行2: 小計（右寄せ） */
  .rowline .prc{ grid-column:2; grid-row:2; text-align:right; font-weight:700 }

  /* 行3: 数量（右寄せ） */
  .qtybar .group{ grid-column:2; grid-row:3; justify-self:end; display:inline-flex; gap:8px; align-items:center }

  /* 行4: 削除（右寄せに修正） */
  .qtybar .btn[data-cart="rm"]{ grid-column:2; grid-row:4; justify-self:end }

  /* 行5: 合計は未使用（表示しない） */
  .totalline{ display:none !important }
  
  /* フォーム2カラム→1カラム */
  .cartgrid{ grid-template-columns:1fr }
}

/* PCでの既定値を再強制（保険） */
@media (min-width:421px){
  .rowline{ display:grid; grid-template-columns:7fr 3fr; align-items:baseline }
  .g2{ display:grid; grid-template-columns:112px 1fr; align-items:center }
  .qtybar{ display:flex; justify-content:flex-end; align-items:center; flex-wrap:wrap }
  .thumb{ width:112px; height:80px }
}

/* フォーム */
.cartform{ border-top:1px dashed #eef2f7; margin-top:8px; padding-top:12px; display:flex; flex-direction:column; gap:10px }
.cartgrid{ display:grid; grid-template-columns:1fr 1fr; gap:8px }
.cartlbl{ font-size:13px; font-weight:700; margin-bottom:4px }
.cartsel{ width:100%; height:40px; border:1px solid var(--border); border-radius:10px; padding:8px 10px; font-size:14px; background:#fff }
.carthelp{ font-size:12px; color:#6b7280 } /* NOTE: HTML側で注釈は非表示運用 */
.cartmemo{ width:100%; min-height:88px; border:1px solid var(--border); border-radius:10px; padding:10px; font-size:14px }
.agrees{ padding-left:12px; border-left:4px solid #f3f4f6; display:flex; flex-direction:column; gap:8px }
.agrees label{ display:flex; align-items:center; gap:8px; font-size:13px }

/* menubar の検索ボックス */
.menu-search{
  margin-left:auto; /* 右寄せ。必要なら消す */
  min-width: 200px;
  max-width: 320px;
  height: 34px;
  padding: 6px 10px;
  border:1px solid var(--border);
  border-radius: 10px;
  font-size: 13px;
}
@media (max-width:420px){
  .menu-search{
    min-width: 0;
    width: 100%;
  }
  .menubar-in{ flex-wrap: wrap; }
}

/* アイコンボタン（虫メガネ） */
.menu-iconbtn{
  display:inline-flex; align-items:center; justify-content:center;
  height:34px; padding:0 10px; margin-left:8px;
  border:1px solid var(--border); border-radius:10px; background:#fff;
  line-height:1; font-size:14px;
}
.menu-iconbtn:active{ transform:translateY(1px); }

/* 折りたたみ検索バー（メニューバーの直下・左寄せフル幅） */
.searchbar{
  width:100%;
  padding:8px 0 0;           /* 上だけ詰める */
  transition:max-height .20s ease, opacity .15s ease;
  overflow:hidden;
}
.searchbar.is-collapsed{
  max-height:0; opacity:0; padding-top:0;
}
.searchbar.is-open{
  max-height:64px; opacity:1;
}

/* 検索入力：左寄せ＋iOSズーム防止（font-size>=16px） */
.menu-search{
  display:block; width:100%;
  height:40px; padding:8px 12px;
  border:1px solid var(--border); border-radius:10px;
  font-size:16px;                 /* ★ iPhone でのズーム防止 */
  line-height:1.2;
  -webkit-text-size-adjust:100%;
  background:#fff;
}

/* 小さな端末ではメニューバーが折り返されても左寄せでOK */
@media (max-width:480px){
  .menubar-in{ flex-wrap:wrap; }
  .menu-iconbtn{ margin-top:8px; }
}


/* ===== カテゴリグリッド ===== */
.ppp-catgrid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:8px }
.ppp-catgrid button{
  display:block; width:100%; text-align:left; border:1px solid var(--border);
  background:#fff; border-radius:10px; padding:10px 12px; font-weight:700; cursor:pointer;
}

/* ===== scroll-lock ===== */
html.ppp-no-scroll, body.ppp-no-scroll{ overflow:hidden !important; touch-action:none !important }

/* ===== Loading UX (skeleton + top progress + fades) ===== */

/* Screen-reader live region */
.sr-only{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}

/* Skeleton cards */
.skel-card{ width:540px; background:#fff; border:1px solid var(--border); border-radius:16px; padding:12px; overflow:hidden }
@media(max-width:720px){ .skel-card{ width:auto } }
.skel-img,.skel-line,.skel-btn{ position:relative; background:#f3f4f6; border-radius:10px; overflow:hidden }
.skel-img{ aspect-ratio:4/3; border:1px solid var(--border) }
.skel-line{ height:14px; margin-top:10px }
.skel-line.big{ height:22px }
.skel-btn{ height:var(--btn-h, 44px); margin-top:10px; border-radius:12px }
@keyframes shimmer{ from{background-position:-200% 0} to{background-position:200% 0} }
.skel-img::before,.skel-line::before,.skel-btn::before{
  content:""; position:absolute; inset:0;
  background:linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.6) 50%, rgba(255,255,255,0) 100%);
  background-size:200% 100%; animation:shimmer 1.2s infinite;
}

/* Top progress bar */
#topProgress{ position:fixed; inset:0 auto auto 0; right:0; height:2px; background:transparent; z-index:9999 }
#topProgress.on::before{
  content:""; position:absolute; left:0; top:0; height:100%; width:30%;
  background:linear-gradient(90deg, var(--brand, #10b981), rgba(16,185,129,.2));
  animation:topbar 0.9s linear infinite;
}
@keyframes topbar{0%{transform:translateX(0)}100%{transform:translateX(330%)}}

/* Blur-up + fade-in for images */
.ppp-img>img{ opacity:0; filter:blur(6px); transition:opacity .25s ease, filter .25s ease }
.ppp-img>img.is-ready{ opacity:1; filter:none }

/* Staggered reveal */
@keyframes cardIn{from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:none}}
.ppp-card{ opacity:0; animation:cardIn .24s ease forwards }

/* Motion safety */
@media (prefers-reduced-motion: reduce){
  .skel-img::before,.skel-line::before,.skel-btn::before{ animation:none }
  #topProgress.on::before{ animation:none }
  .ppp-card{ animation:none; opacity:1 }
}

/* ===== Variant Mode Bar ===== */
.variantbar{ display:none; background:#fff; border-bottom:1px solid var(--border) }
.variantbar[aria-hidden="false"]{ display:block }
.variantbar-in{
  max-width:var(--wrap); margin:0 auto; padding:8px 16px;
  display:flex; gap:8px; align-items:center; flex-wrap:wrap;
}
.variantbar .lbl{ font-size:12px; color:#64748b }
.variantbar .title{ font-weight:800 }
.mini-btn,.mini-x{
  appearance:none; border:1px solid var(--border); background:#fff; border-radius:999px;
  padding:4px 10px; cursor:pointer; font-weight:700; font-size:12px;
}
.mini-btn:active,.mini-x:active{ transform:translateY(1px) }

/* 選択中カードの軽ハイライト */
.ppp-card.is-selected{ box-shadow:0 0 0 2px #bbf7d0 inset; border-color:#86efac }

}

/* === 商品詳細ドロワ（翌日受取・在庫=有無のみ） === */
.detail-body{ display:grid; grid-template-columns:1fr; gap:10px }
@media(min-width:768px){ .detail-body{ grid-template-columns:1.2fr 1fr } }

.detail-media{ border:1px solid var(--border); border-radius:12px; overflow:hidden; background:#fff; }
.detail-media img{ width:100%; height:auto; display:block; object-fit:contain; aspect-ratio:4/3; }

.detail-name{ font-weight:800; font-size:18px; line-height:1.3; margin-bottom:6px }
.detail-price{ font-weight:900; font-size:22px }
.detail-unit{ font-size:12px; color:#6b7280; text-align:right }
.detail-min{ font-size:13px; color:#065f46; background:#f0fdf4; border:1px solid #d1fae5; border-radius:8px; padding:6px 8px; display:inline-block; margin:6px 0 }
.detail-prenote{ font-size:13px; color:#334155; margin:6px 0 }
.detail-desc{ font-size:14px; color:#475569; line-height:1.7; white-space:pre-wrap }

.detail-variants{ display:flex; flex-wrap:wrap; gap:6px; margin:6px 0 }
.detail-variants .ppp-pill{ flex:0 0 auto; padding:6px 10px }

.detail-suggest-grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:8px }
.sugg{ border:1px solid var(--border); border-radius:10px; padding:8px; background:#fff; display:grid; gap:6px }
.sugg .img{ aspect-ratio:4/3; border:1px solid var(--border); border-radius:8px; overflow:hidden; background:#fff }
.sugg .img img{ width:100%; height:100%; object-fit:cover }
.sugg .nm{ font-size:13px; font-weight:700; line-height:1.3; overflow:hidden; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical }
.sugg .pr{ font-size:13px; text-align:right; font-weight:800 }
.sugg .btn{ border:1px solid var(--border); border-radius:8px; height:36px; font-weight:800; background:#fff; cursor:pointer }

/* 在庫/終売チップの色 */
#detailStockChip{ background:#ecfeff; border-color:#a5f3fc; color:#075985 }
#detailEolChip{ background:#fee2e2; border-color:#fecaca; color:#7f1d1d }
/* ===== もっと見る（明確なボタン） ===== */
.ppp-descwrap { position: relative; }
.ppp-morebtn{
  display:inline-flex; align-items:center; gap:.5em;
  padding:8px 12px; border:1px solid var(--border); border-radius:9999px;
  background:#f1f5f9; color:#334155; font-weight:700; font-size:13px;
  text-decoration:none;
}
.ppp-morebtn::after{ content:"→"; }

/* 最短受取（囲い文字ごと）非表示 */
#detailDrawer .ppp-chips [data-chip="min"]{ display:none !important; }
#detailDrawer #detailMinDate,
#detailDrawer .detail-min{ display:none !important; } /* 念押し */

/* フッター：左＝あとで/お気に入り、右＝戻る/カート追加 */
#detailDrawer .ppp-drawer__footer{
  display:flex; align-items:center; gap:8px; padding:8px 12px;
  justify-content:flex-start;
}
#detailDrawer #detailBack{ margin-left:auto; }   /* ここから右側グループ */
#detailDrawer #detailAdd{ /* カート追加は右端に寄る */ }

/* 戻るの見た目（控えめなゴーストボタン） */
.ppp-btn.ghost{
  background:#fff; border:1px solid var(--border); color:#334155; font-weight:800;
}

/* ===== 詳細ドロワ：SPで“詳細中”の視覚サイン強化 ===== */
@media (max-width: 720px){
  #detailDrawer .ppp-drawer__panel{ box-shadow:-24px 0 48px rgba(0,0,0,.20); }
  #detailDrawer .ppp-drawer__bar{
    position: sticky; top: 0; background:#fff; z-index: 1;
    box-shadow: 0 4px 12px rgba(0,0,0,.06);
  }
  /* 上端ハンドル（ドラッグの取っ手風） */
  #detailDrawer .ppp-drawer__panel::before{
    content:""; display:block; width:40px; height:4px; border-radius:2px;
    background:#cbd5e1; margin:8px auto 0;
  }
  #detailDrawer .ppp-drawer__scrim{ background:rgba(15,23,42,.5); }
}

/* ===== 詳細ドロワ：不要要素は非表示 ===== */
/* 在庫ありバッジ／最短受取／バリエーション／人気順ボタンを隠す */
#detailDrawer #detailStockChip,
#detailDrawer #detailMinDate,
#detailDrawer .detail-min,
#detailDrawer .detail-variants,
#detailDrawer [data-sort="popular"]{
  display:none !important;
}

/* ===== 詳細フッター：左＝あとで/お気に入り、右＝カート追加 ===== */
#detailDrawer .ppp-drawer__footer{
  display:flex; align-items:center; gap:8px; padding:8px 12px;
  justify-content:flex-start; /* 既定の右寄せを上書き */
}
#detailDrawer #detailAdd{ margin-left:auto; } /* 右端へ */


/* === Menubar 密度＆回り込み防止 ===================== */
.menubar-in{
  display:flex;
  gap:6px;                  /* 余白をさらに詰める */
  flex-wrap:nowrap;         /* ★ 折り返さない＝検索アイコンが回り込まない */
  overflow-x:auto;          /* はみ出すときは横スクロール（スマホ向け） */
  -webkit-overflow-scrolling: touch;
  scrollbar-width:none;
}
.menubar-in::-webkit-scrollbar{ display:none; }

.menubar-in .ppp-btn,
.menubar-in .menu-iconbtn{
  height:30px;              /* 32→30でタイト化 */
  padding:0 8px;            /* 横余白さらに詰める */
  border-radius:10px;
  flex:0 0 auto;            /* ★ 幅を勝手に伸縮させない */
}

/* 検索トグル（虫メガネ）だけは常に1ボタン分の幅に */
.menu-iconbtn{ min-width:34px; }
/* 検索バーも高さを30pxに合わせる */
.menu-search{
  height:30px;
  padding:5px 10px;
  font-size:16px;           /* iOSズーム防止のため16px以上 */
} 

/* === Searchbar 左寄せ＆タイト化 ===================== */
.searchbar{
  padding:6px 0 0;
  margin:0;                 /* ★ 左寄せ固定（中央寄せの原因になりがちなautoマージンを排除） */
  max-width:100%;
}
.searchbar.is-open{ max-height:52px; }

.searchbox{ position:relative; margin:0; } /* 左寄せ固定 */

.menu-search{
  width:100%;
  height:34px;              /* 36→34 さらに締める（※フォント16px維持） */
  padding:5px 10px;         /* 内側の空きをもっとタイトに */
  padding-right:36px;       /* 右の×ボタン分だけ確保 */
  border-radius:8px;
  font-size:16px;           /* ★ iOSズーム防止 */
  line-height:1.2;
  text-align:left;          /* 明示的に左寄せ */
}
.search-clear{
  right:6px; width:26px; height:26px; font-size:18px;
}

/* === Focus 視覚調整＆重なり防止 ===================== */
.menu-search:focus{
  outline:none;                                /* デフォルトの青アウトラインを消す */
  border-color: var(--brand, #2a7cf6);
  box-shadow: 0 0 0 2px rgba(42,124,246,.15);  /* 控えめな発光に置換 */
}
.searchbar{ margin-bottom:10px; }              /* ★ 下に余白を足してカードと分離 */

@layer overrides {
  /* 検索入力の左寄せを強制（古い margin-left:auto を無効化） */
  .menu-search{
    margin: 0 !important;       /* ← これが効きます */
    width: 100%;
    height: 34px;
    padding: 5px 10px;          /* タイトに */
    font-size: 16px;            /* iPhoneズーム防止 */
    border-radius: 8px;
    text-align: left;
  }

  /* 検索バーの“重なり”を防ぐため余白を確保＆視覚分離 */
  .searchbar{ margin-bottom: 10px; }
  .menu-search:focus{
    outline: none;
    border-color: var(--brand, #2a7cf6);
    box-shadow: 0 0 0 2px rgba(42,124,246,.15);
    background: #fff;           /* フォーカス時も下のカード色が透けない */
  }

  /* ボタンが折り返されて虫メガネが回り込まないよう固定 */
  .menubar-in{
    display: flex; gap: 6px; align-items: center;
    flex-wrap: nowrap;
    overflow-x: auto; -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .menubar-in::-webkit-scrollbar{ display:none; }
  .menubar-in .ppp-btn, .menubar-in .menu-iconbtn{
    flex: 0 0 auto; height: 30px; padding: 0 8px; border-radius: 10px;
  }
  .menu-iconbtn{ min-width: 34px; }
}

  /* メニューバー直下の検索バーをギリギリまで詰める */
  .searchbar{ padding-top: 2px; margin-bottom: 8px; } /* 下は8pxだけ確保：カードと接触しない最低限 */
  /* .menubar 直後の .wrap で余白が付く場合の保険 */
  .menubar .wrap + .wrap { margin-top: 0; }

  /* 入力は16px維持（iPhoneズーム防止）＋タイトな内側余白 */
  .searchbox{ position: relative; margin: 0; }
  .menu-search{
    width: 100%;
    height: 34px;
    padding: 5px 10px;       /* タイトに */
    padding-right: 36px;     /* ×ボタン分だけ確保 */
    font-size: 16px;
    line-height: 1.2;
    border-radius: 8px;
    text-align: left;
    margin: 0 !important;    /* 左寄せを強制（旧margin-left:autoを無効化） */
  }

  /* ×クリアボタン：小さめ見た目＋十分なタップ領域 */
  .search-clear{
    position: absolute; right: 6px; top: 50%; transform: translateY(-50%);
    width: 26px; height: 26px; border: 0; background: transparent;
    font-size: 18px; line-height: 1; color: #666; border-radius: 13px;
  }
  .search-clear:active{ transform: translateY(-50%) scale(.96); }

  /* フォーカス時の“青かぶり”を抑える（カードと視覚分離） */
  .menu-search:focus{
    outline: none;
    border-color: var(--brand, #2a7cf6);
    box-shadow: 0 0 0 2px rgba(42,124,246,.15);
    background: #fff;
  }


